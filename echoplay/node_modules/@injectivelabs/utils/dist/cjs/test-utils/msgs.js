"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.prepareEip712 = void 0;
const networks_1 = require("@injectivelabs/networks");
const index_js_1 = require("./mocks/index.js");
const BigNumber_js_1 = __importDefault(require("../classes/BigNumber.js"));
const constants_js_1 = require("../constants.js");
const prepareEip712 = ({ messages, gas = constants_js_1.DEFAULT_GAS_LIMIT, network = networks_1.Network.Mainnet, injectiveAddress = index_js_1.mockFactory.injectiveAddress, ethereumAddress = index_js_1.mockFactory.ethereumAddress, endpoints = {}, accountNumber = 1, sequence = 1, timeoutHeight = 999_999_999, memo = '', }) => {
    const chainInfo = (0, networks_1.getNetworkInfo)(network);
    const actualEndpoints = { ...(0, networks_1.getNetworkEndpoints)(network), ...endpoints };
    const msgs = Array.isArray(messages) ? messages : [messages];
    const web3Msgs = msgs.map((msg) => msg.toWeb3());
    const { tx, eip712 } = index_js_1.mockFactory.eip712Tx({
        ...chainInfo,
        accountNumber,
        sequence,
        timeoutHeight,
        memo,
    });
    const eip712Args = {
        msgs,
        fee: {
            amount: [
                {
                    denom: 'inj',
                    amount: new BigNumber_js_1.default(gas.toString())
                        .times(constants_js_1.DEFAULT_GAS_PRICE)
                        .toFixed(),
                },
            ],
            gas: gas.toString(),
            payer: injectiveAddress,
        },
        tx: {
            ...tx,
            sequence: sequence.toString(),
            timeoutHeight: timeoutHeight.toString(),
            accountNumber: accountNumber.toString(),
        },
        evmChainId: eip712.evmChainId,
    };
    const prepareEip712Request = {
        ...eip712,
        chainId: eip712.evmChainId,
        message: web3Msgs,
        gasLimit: gas,
        address: ethereumAddress,
    };
    return { endpoints: actualEndpoints, eip712Args, prepareEip712Request };
};
exports.prepareEip712 = prepareEip712;
